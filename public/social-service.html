<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Social Service - Innovate</title>
  <link rel="stylesheet" href="/css/instagram.css">
  <link rel="stylesheet" href="/css/experiences.css">
  <link rel="stylesheet" href="/css/social-service.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Top Navigation -->
  <header class="exp-topbar">
    <div class="exp-topbar-inner">
      <a class="exp-brand" href="/home">Innovate</a>

      <div class="exp-search exp-search-desktop" title="Search">
        <span style="opacity:0.7;">üîé</span>
        <input id="searchInput" type="text" placeholder="Search donations..." />
      </div>

      <div class="exp-actions">
        <button class="exp-icon-btn exp-search-mobile-btn" id="mobileSearchBtn" type="button" title="Search" style="display: none;">üîé</button>
        <button class="exp-icon-btn" onclick="openCreateModal()" type="button" title="Create donation">Ôºã</button>
        <a class="exp-icon-btn" href="/notifications" title="Notifications" style="text-decoration:none;">üîî</a>
        <a class="exp-icon-btn" href="/home" title="Home" style="text-decoration:none;">üè†</a>
      </div>
      
      <!-- Mobile search overlay -->
      <div class="exp-search-mobile-overlay" id="mobileSearchOverlay" style="display: none;">
        <div class="exp-search-mobile-container">
          <button class="exp-icon-btn" id="closeMobileSearch" type="button">‚Üê</button>
          <input id="searchInputMobile" type="text" placeholder="Search donations..." style="flex: 1; border: none; background: transparent; color: var(--ig-primary-text); font-size: 15px; outline: none;" />
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="ig-main exp-main" style="padding-bottom: 80px;">
    <!-- Hero Section -->
    <div class="ss-hero" id="hero-section">
      <div class="ss-hero-icon">ü§ù</div>
      <h1 class="ss-hero-title">Make a Difference</h1>
      <p class="ss-hero-subtitle">Donate items you don't need or help pick up donations. Together, we build a better community.</p>
      
      <!-- Stats -->
      <div class="ss-hero-stats">
        <div class="ss-stat">
          <div>
            <div class="ss-stat-value" id="stat-total">0</div>
            <div class="ss-stat-label">Total Donations</div>
          </div>
        </div>
        <div class="ss-stat">
          <div>
            <div class="ss-stat-value" id="stat-active">0</div>
            <div class="ss-stat-label">Active</div>
          </div>
        </div>
        <div class="ss-stat">
          <div>
            <div class="ss-stat-value" id="stat-completed">0</div>
            <div class="ss-stat-label">Completed</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="ss-tabs">
      <button class="ss-tab active" onclick="switchTab('donations')" id="donations-tab">
        <i class="fas fa-hand-holding-heart"></i> All Donations
      </button>
      <button class="ss-tab" onclick="switchTab('mine')" id="mine-tab">
        <i class="fas fa-user"></i> My Donations
      </button>
      <button class="ss-tab" onclick="switchTab('picked')" id="picked-tab">
        <i class="fas fa-check-circle"></i> Picked by Me
      </button>
    </div>

    <!-- Donations Tab -->
    <div id="donations-content">
      <div id="donations-list"></div>
    </div>

    <!-- My Donations Tab -->
    <div id="mine-content" style="display: none;">
      <div id="mine-list"></div>
    </div>

    <!-- Picked Tab -->
    <div id="picked-content" style="display: none;">
      <div id="picked-list"></div>
    </div>
  </main>

  <!-- Create/Edit Donation Modal -->
  <div id="create-modal" class="ig-modal-overlay" style="display: none;">
    <div class="ig-modal" style="max-width: 860px;">
      <div class="ss-modal-header">
        <h3 class="ss-modal-title" id="modal-title">Create Donation</h3>
        <button onclick="closeCreateModal()" class="ss-modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="ss-modal-body">
        <form id="donation-form" onsubmit="submitDonation(); return false;">
          <input type="hidden" id="donation-id">
          
          <div class="ss-form-row">
            <div class="ss-form-group">
              <label class="ss-form-label">Title</label>
              <input 
                type="text" 
                id="donation-title" 
                class="ss-form-input"
                required 
                placeholder="e.g., Winter clothes for donation"
                maxlength="100"
              >
            </div>

            <div class="ss-form-group">
              <label class="ss-form-label">Category</label>
              <input 
                type="text" 
                id="donation-category" 
                class="ss-form-input"
                placeholder="e.g., Clothes, Books, Furniture"
              >
            </div>
          </div>

          <div class="ss-form-group">
            <label class="ss-form-label">City</label>
            <input 
              type="text" 
              id="donation-city" 
              class="ss-form-input"
              placeholder="e.g., Hyderabad, Mumbai, Delhi"
            >
          </div>

          <div class="ss-form-group">
            <label class="ss-form-label">Description</label>
            <textarea 
              id="donation-description" 
              class="ss-form-textarea"
              placeholder="Describe what you're donating, condition, sizes, etc..."
              rows="4"
            ></textarea>
          </div>

          <div class="ss-form-group">
            <label class="ss-form-label">Pickup Address</label>
            <input 
              type="text" 
              id="donation-address" 
              class="ss-form-input"
              required 
              placeholder="Enter complete pickup address"
            >
          </div>

          <div class="ss-form-group">
            <label class="ss-form-label">Upload Photos (optional)</label>
            <input 
              type="file" 
              id="donation-images" 
              accept="image/*" 
              multiple
              class="ss-file-input"
              onchange="previewImages()"
            >
            <div class="ss-file-hint">Upload up to 5 photos (PNG, JPG up to 5MB each)</div>
            <div id="image-preview" class="ss-image-preview"></div>
          </div>

          <div class="ss-form-row">
            <div class="ss-form-group">
              <button type="button" onclick="getAddress()" class="ss-location-btn">
                <i class="fas fa-map-marker-alt"></i>
                <span>Get Address</span>
              </button>
            </div>
            <div class="ss-form-group">
              <button type="button" onclick="shareLocation()" class="ss-location-btn ss-location-btn-share">
                <i class="fas fa-share-alt"></i>
                <span>Share Location</span>
              </button>
            </div>
          </div>

          <input type="hidden" id="donation-latitude">
          <input type="hidden" id="donation-longitude">
        </form>
      </div>
      <div class="ss-modal-footer">
        <button onclick="submitDonation()" class="ss-btn ss-btn-primary ss-btn-full">
          Post Donation
        </button>
      </div>
    </div>
  </div>

  <!-- Donation Detail Modal -->
  <div id="donation-detail-modal" class="ig-modal-overlay" style="display: none;">
    <div style="max-width: 1080px; width: 95%; max-height: 90vh; margin: auto; display: flex; background: var(--ig-secondary-background); border-radius: 12px; overflow: hidden;">
      <!-- Image Section -->
      <div style="flex: 0 0 60%; position: relative; background: #000;">
        <button onclick="closeDonationDetail()" class="ss-detail-close">
          <i class="fas fa-times"></i>
        </button>
        <div id="detail-images-container" style="height: 100%; display: flex; align-items: center; justify-content: center; position: relative;">
          <!-- Images will be loaded here -->
        </div>
      </div>
      
      <!-- Details Section -->
      <div style="flex: 1; display: flex; flex-direction: column; overflow-y: auto;">
        <div style="padding: 24px;">
          <!-- User Info -->
          <div class="ss-detail-user" id="detail-user-info" onclick="event.stopPropagation();">
            <!-- User info will be loaded here -->
          </div>
          
          <!-- Title and Status -->
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-top: 20px;">
            <h2 id="detail-title" style="font-size: 24px; font-weight: 900; color: var(--ig-primary-text); flex: 1;"></h2>
            <div id="detail-status-badge"></div>
          </div>
          
          <!-- Meta Info -->
          <div id="detail-meta" class="ss-card-meta" style="margin-top: 12px;"></div>
          
          <!-- Description -->
          <div id="detail-description" style="margin-top: 16px; color: var(--ig-secondary-text); line-height: 1.6;"></div>
          
          <!-- Location -->
          <div id="detail-location" style="margin-top: 16px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px; border: 1px solid var(--ig-border);">
            <!-- Location will be loaded here -->
          </div>
          
          <!-- Picker Info -->
          <div id="detail-picker-info"></div>
          
          <!-- Completion Photos -->
          <div id="detail-completion-photos"></div>
          
          <!-- Share Location Link -->
          <div id="detail-share-link" style="margin-top: 16px;"></div>
        </div>
        
        <!-- Action Buttons -->
        <div id="detail-actions" style="padding: 20px; border-top: 1px solid var(--ig-border); margin-top: auto;">
          <!-- Buttons will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Completion Photos Modal -->
  <div id="completion-modal" class="ig-modal-overlay" style="display: none;">
    <div class="ig-modal" style="max-width: 600px;">
      <div class="ss-modal-header">
        <h3 class="ss-modal-title">Complete Donation</h3>
        <button onclick="closeCompletionModal()" class="ss-modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="ss-modal-body">
        <input type="hidden" id="completion-donation-id">
        <div class="ss-info-box">
          <i class="fas fa-info-circle"></i>
          <p>Upload photos to confirm successful donation pickup</p>
        </div>
        <div class="ss-form-group">
          <label class="ss-form-label">Upload Completion Photos</label>
          <input 
            type="file" 
            id="completion-photos" 
            accept="image/*" 
            multiple
            class="ss-file-input"
            onchange="previewCompletionPhotos()"
          >
          <div class="ss-file-hint">Upload proof of successful pickup</div>
          <div id="completion-preview" class="ss-image-preview"></div>
        </div>
      </div>
      <div class="ss-modal-footer">
        <button onclick="uploadCompletionPhotos()" class="ss-btn ss-btn-success ss-btn-full">
          Mark as Complete
        </button>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="ig-bottom-nav">
    <a href="/home" class="ig-bottom-nav-item">
      <svg aria-label="Home" viewBox="0 0 24 24" width="24">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
        <polyline points="9 22 9 12 15 12 15 22" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="ig-bottom-nav-label">Home</span>
    </a>
    <a href="/communities" class="ig-bottom-nav-item">
      <svg aria-label="Communities" viewBox="0 0 24 24" width="24">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" fill="none"/>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="ig-bottom-nav-label">Communities</span>
    </a>
    <a href="/events" class="ig-bottom-nav-item">
      <svg aria-label="Events" viewBox="0 0 24 24" width="24">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
        <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
      </svg>
      <span class="ig-bottom-nav-label">Events</span>
    </a>
    <button class="ig-bottom-nav-item" onclick="openCreateModal()" style="background: none; border: none; cursor: pointer;">
      <svg aria-label="Create" viewBox="0 0 24 24" width="24">
        <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
      </svg>
      <span class="ig-bottom-nav-label">Create</span>
    </button>
    <a href="/social-service" class="ig-bottom-nav-item active">
      <svg aria-label="Social Service" viewBox="0 0 24 24" width="24">
        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="ig-bottom-nav-label">Service</span>
    </a>
    <a href="/search" class="ig-bottom-nav-item">
      <svg aria-label="Search" viewBox="0 0 24 24" width="24">
        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
        <line x1="21" y1="21" x2="16.65" y2="16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span class="ig-bottom-nav-label">Search</span>
    </a>
    <a href="#" class="ig-bottom-nav-item" id="profileNavLink" onclick="navigateToProfile(event)">
      <svg aria-label="Profile" viewBox="0 0 24 24" width="24">
        <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" fill="none"/>
        <path d="M5.5 21v-2a7.5 7.5 0 0 1 13 0v2" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
      </svg>
      <span class="ig-bottom-nav-label">Profile</span>
    </a>
  </nav>

  <script>
    function navigateToProfile(e) {
      e.preventDefault();
      const user = InnovateAPI.getCurrentUser();
      if (user && user.id) {
        window.location.href = `/profile/${user.id}`;
      }
    }
  </script>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/app.js"></script>
  <script src="/js/instagram-theme.js"></script>
  <script src="/js/social-service.js"></script>
</body>
</html>
